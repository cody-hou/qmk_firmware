// Copyright 2023 Anjheos (@Anjheos)
// SPDX-License-Identifier: GPL-2.0-or-later
// Modified by Cody Hou

#include QMK_KEYBOARD_H


/* ---------- Keymap ---------- */
// Layer names
enum layer_names {
    _QWERTY,
    _SYM,
    _NUM,
    _NAV,
    _FUN
};

// Key layer definitions
const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
  [_QWERTY] = LAYOUT_225_1(
    QK_GESC,   KC_Q,      KC_W,      KC_E,      KC_R,      KC_T,      KC_Y,      KC_U,      KC_I,      KC_O,      KC_P,      KC_BSPC,
    KC_TAB,    KC_A,      KC_S,      KC_D,      KC_F,      KC_G,      KC_H,      KC_J,      KC_K,      KC_L,      KC_SCLN,   KC_ENT,
    KC_LSFT,   KC_Z,      KC_X,      KC_C,      KC_V,      KC_B,      KC_N,      KC_M,      KC_COMMA,  KC_DOT,    KC_SLSH,   KC_UP,     _______,
    KC_LCTL,   KC_LGUI,   KC_LALT,   MO(_SYM),             MO(_NUM),  KC_SPC,    MO(_NAV),  MO(_FUN),             KC_LEFT,   KC_DOWN,   KC_RIGHT
  ),
  [_SYM] = LAYOUT_225_1(
    _______,   S(KC_1),   S(KC_2),   S(KC_3),   S(KC_4),   S(KC_5),   S(KC_6),   S(KC_7),   S(KC_8),   S(KC_9),   S(KC_0),   _______,
    _______,   S(KC_BSLS),_______,   _______,   _______,   _______,   _______,   _______,   KC_LBRC,   KC_RBRC,   KC_QUOT,   _______,
    _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   S(KC_LBRC),S(KC_RBRC),S(KC_QUOT),_______,   _______,
    _______,   _______,   _______,   _______,              _______,   _______,   _______,   _______,              _______,   _______,   _______
  ),
  [_NUM] = LAYOUT_225_1(
    _______,   KC_1,      KC_2,      KC_3,      KC_4,      KC_5,      KC_6,      KC_7,      KC_8,      KC_9,      KC_0,      _______,
    _______,   _______,   _______,   _______,   _______,   _______,   _______,   KC_MINS,   S(KC_MINS),KC_EQL,    S(KC_EQL), _______,
    _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   KC_BSLS,   _______,   _______,   _______, 
    _______,   _______,   _______,   _______,              _______,   _______,   _______,   _______,              _______,   _______,   _______
  ),
  [_NAV] = LAYOUT_225_1(
    _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   KC_PSCR,   KC_SCRL,   KC_PAUS,   KC_DEL,
    KC_CAPS,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   KC_HOME,   KC_PGUP,   KC_INS,    _______,
    _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   KC_END,    KC_PGDN,   KC_NUM,    _______,   _______, 
    _______,   _______,   _______,   _______,              _______,   _______,   _______,   _______,              _______,   _______,   _______
  ),
  [_FUN] = LAYOUT_225_1(
    _______,   KC_F1,     KC_F2,     KC_F3,     KC_F4,     KC_F5,     KC_F6,     KC_F7,     KC_F8,     KC_F9,     KC_F10,    _______,
    _______,   KC_F11,    KC_F12,    _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,
    _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,   _______,
    _______,   _______,   _______,   _______,              KC_MSTP,   KC_MPLY,   _______,   _______,              KC_MPRV,   _______,   KC_MNXT
  )

};

// Encoder layer definitions
#if defined(ENCODER_MAP_ENABLE)
const uint16_t PROGMEM encoder_map[][NUM_ENCODERS][NUM_DIRECTIONS] = {
    [_QWERTY] = { ENCODER_CCW_CW(KC_AUDIO_VOL_DOWN, KC_AUDIO_VOL_UP)},
    [_SYM] = { ENCODER_CCW_CW(QK_MOUSE_WHEEL_LEFT, QK_MOUSE_WHEEL_RIGHT)},
    [_NUM] = { ENCODER_CCW_CW(QK_MOUSE_WHEEL_DOWN, QK_MOUSE_WHEEL_UP)},
    [_FUN] = { ENCODER_CCW_CW(KC_BRIGHTNESS_DOWN, KC_BRIGHTNESS_UP)}
};
#endif

// Minivan-style RGB definitions
const rgblight_segment_t PROGMEM _caps_layer[] = RGBLIGHT_LAYER_SEGMENTS(
    {0, 3, HSV_RED}
);

const rgblight_segment_t PROGMEM _sym_layer[] = RGBLIGHT_LAYER_SEGMENTS(
    {0, 1, HSV_SPRINGGREEN}
);

const rgblight_segment_t PROGMEM _num_layer[] = RGBLIGHT_LAYER_SEGMENTS(
    {1, 1, HSV_GREEN}
);

const rgblight_segment_t PROGMEM _nav_layer[] = RGBLIGHT_LAYER_SEGMENTS(
    {2, 1, HSV_CHARTREUSE}
);

const rgblight_segment_t PROGMEM _fun_layer[] = RGBLIGHT_LAYER_SEGMENTS(
    {0, 1, HSV_CYAN}
);

const rgblight_segment_t* const PROGMEM _rgb_layers[] = RGBLIGHT_LAYERS_LIST(
    _caps_layer,
    _sym_layer,
    _num_layer,
    _nav_layer,
    _fun_layer
);

void keyboard_post_init_user (void) {
    rgblight_layers = _rgb_layers;
    rgblight_sethsv_noeeprom(HSV_BLACK);
}

bool led_update_user(led_t led_state) {
    rgblight_set_layer_state(0, led_state.caps_lock);
    return true;
}

layer_state_t layer_state_set_user(layer_state_t state) {
    rgblight_set_layer_state(1, layer_state_cmp(state, _SYM));
    rgblight_set_layer_state(2, layer_state_cmp(state, _NUM));
    rgblight_set_layer_state(3, layer_state_cmp(state, _NAV));
    rgblight_set_layer_state(4, layer_state_cmp(state, _FUN));
    return state;
}


/* ---------- OLED ---------- */
#ifdef OLED_ENABLE

// Stardew Valley chicken animation
// Adapted from https://github.com/nwii/oledbongocat
#define IDLE_FRAMES 2
#define IDLE_SPEED 20 // Trigger idle animation below this WPM

#define PREP_FRAMES 1 
 
#define TAP_FRAMES 4
#define TAP_SPEED 40  // Trigger walking animation above this WPM

#define ANIM_FRAME_DURATION 500  // Frame duration in ms
#define ANIM_SIZE 512 // Number of bytes in array, minimize for adequate firmware size, max is 1024 (not really sure what is a good number)

uint32_t anim_timer         = 0;
uint32_t anim_sleep         = 0;
uint8_t  current_idle_frame = 0;
// uint8_t current_prep_frame = 0; // uncomment if PREP_FRAMES >1
uint8_t current_tap_frame = 0;

// For WPM counter
char wpm_str[10];

// Render function
static void render_anim(void) {
    // Images
    // Sprites from Stardew Valley by Eric Barone
    // Translated into byte arrays using https://javl.github.io/image2cpp/
    static const char PROGMEM idle[IDLE_FRAMES][ANIM_SIZE] = {
        {
            // 'idle1', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x3c, 0x3c, 0xfc, 0xfc, 0xfc, 0xfc, 0x7c, 0x7c, 0xf0, 0xf0, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00,
            0xf0, 0xf0, 0x0c, 0x0c, 0x0c, 0x1c, 0x30, 0x30, 0x30, 0x70, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0,
            0x7f, 0x3f, 0x01, 0x00, 0x00, 0x30, 0x30, 0x30, 0x00, 0x00, 0x00, 0xc1, 0xcf, 0xcf, 0x30, 0x30,
            0xf3, 0xf3, 0xdf, 0x8e, 0x0c, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0xfc, 0xfc,
            0x00, 0x00, 0x03, 0x03, 0x0e, 0x0c, 0x3c, 0x3c, 0x33, 0x33, 0xff, 0xff, 0xcf, 0xcf, 0xf3, 0xf3,
            0xc3, 0xc3, 0xc0, 0xc0, 0xc0, 0xc0, 0xf0, 0xf0, 0x30, 0x30, 0x38, 0x3c, 0x0c, 0x0e, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03 
        },

        {
            // 'idle2', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xf0, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0xc0, 0xc0, 0x30, 0x30, 0x30, 0x70, 0xc0, 0xc0, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0xfc, 0xfc, 0x07, 0x03, 0x03, 0xc3, 0xc1, 0xc1, 0x03, 0x03, 0x03, 0x07, 0x3c, 0x3c, 0xc0, 0xc0,
            0xcf, 0xcf, 0x7c, 0x38, 0x30, 0x00, 0x00, 0x00, 0xc0, 0xc1, 0xc3, 0xc3, 0x03, 0x03, 0x03, 0x03,
            0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x0f, 0x1f, 0xf0, 0xf0,
            0x03, 0x03, 0x0f, 0x0e, 0x38, 0x30, 0xf0, 0xf0, 0xcf, 0xcf, 0xfc, 0xfc, 0xfc, 0xfc, 0xcc, 0xcc,
            0xcc, 0xcc, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xe0, 0xf0, 0x30, 0x38, 0x0f, 0x0f,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03
        }
    };

    static const char PROGMEM prep[PREP_FRAMES][ANIM_SIZE] = {
        {
            // 'prep', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0xcf, 0xcf, 0x7f, 0x3f, 0x3f, 0x3f, 0x1f, 0x1f, 0x3c, 0x3c, 0x30, 0x70, 0xc0, 0xc0, 0x00, 0x00,
            0xfc, 0xfc, 0xc3, 0x83, 0x03, 0x07, 0x0c, 0x0c, 0x0c, 0x1c, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
            0x1f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x1e, 0x1e, 0x00, 0x00, 0x00, 0x30, 0xf3, 0xf3, 0x0c, 0x0c,
            0x3c, 0x3c, 0xf7, 0xe3, 0x83, 0x00, 0x00, 0x00, 0xfc, 0xfc, 0xcc, 0xcc, 0xc0, 0xc0, 0xc0, 0xc0,
            0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x81, 0xff, 0xff,
            0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x0f, 0x0f, 0x0c, 0x0c, 0xff, 0xff, 0x1f, 0x1f, 0x3c, 0x3c,
            0x30, 0x30, 0xf0, 0xf0, 0x30, 0x30, 0xfc, 0xfc, 0x0c, 0x0c, 0x0e, 0x0f, 0x03, 0x03, 0x00, 0x00,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03
        }
    };

    static const char PROGMEM tap[TAP_FRAMES][ANIM_SIZE] = {
        {
            // 'walk1', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x3c, 0x3c, 0xfc, 0xfc, 0xfc, 0xfc, 0x7c, 0x7c, 0xf0, 0xf0, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00,
            0xf0, 0xf0, 0x0c, 0x0c, 0x0c, 0x1c, 0x30, 0x30, 0x30, 0x70, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0,
            0x7f, 0x3f, 0x01, 0x00, 0x00, 0x00, 0x78, 0x78, 0x00, 0x00, 0x00, 0xc1, 0xcf, 0xcf, 0x30, 0x30,
            0xf3, 0xf3, 0xdf, 0x8e, 0x0c, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0xfc, 0xfc,
            0x00, 0x00, 0x03, 0x03, 0x0e, 0x0c, 0xfc, 0xfc, 0x33, 0x33, 0xff, 0xff, 0xf3, 0xf3, 0xf3, 0xf3,
            0xc3, 0xc3, 0xc0, 0xc0, 0x30, 0x30, 0x0c, 0x0c, 0xcc, 0xcc, 0x3c, 0x3c, 0x0c, 0x0e, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03
        },

        {
            // 'walk2', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0xcf, 0xcf, 0x7f, 0x3f, 0x3f, 0x3f, 0x1f, 0x1f, 0x3c, 0x3c, 0x30, 0x70, 0xc0, 0xc0, 0x00, 0x00,
            0xfc, 0xfc, 0xc3, 0x83, 0x03, 0x07, 0x0c, 0x0c, 0x0c, 0x1c, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
            0x1f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x1e, 0x1e, 0x00, 0x00, 0x00, 0x30, 0xf3, 0xf3, 0x0c, 0x0c,
            0x3c, 0x3c, 0xf7, 0xe3, 0x83, 0x00, 0x00, 0x00, 0xfc, 0xfc, 0xcc, 0xcc, 0xc0, 0xc0, 0xc0, 0xc0,
            0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x81, 0xff, 0xff,
            0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x0f, 0x0f, 0x0c, 0x0c, 0xff, 0xff, 0x1f, 0x1f, 0x3c, 0x3c,
            0x30, 0x30, 0xf0, 0xf0, 0x30, 0x30, 0x3c, 0x3c, 0xcc, 0xcc, 0x0e, 0x0f, 0x03, 0x03, 0x00, 0x00,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03
        },

        {
            // 'walk3', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x3c, 0x3c, 0xfc, 0xfc, 0xfc, 0xfc, 0x7c, 0x7c, 0xf0, 0xf0, 0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00,
            0xf0, 0xf0, 0x0c, 0x0c, 0x0c, 0x1c, 0x30, 0x30, 0x30, 0x70, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0,
            0x7f, 0x3f, 0x01, 0x00, 0x00, 0x00, 0x78, 0x78, 0x00, 0x00, 0x00, 0xc1, 0xcf, 0xcf, 0x30, 0x30,
            0xf3, 0xf3, 0xdf, 0x8e, 0x0c, 0x00, 0x00, 0x00, 0xf0, 0xf0, 0x30, 0x30, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x07, 0xfc, 0xfc,
            0x00, 0x00, 0x03, 0x03, 0x0e, 0x0c, 0x3c, 0x3c, 0xcf, 0xcf, 0x0f, 0x1f, 0x3f, 0x3f, 0xf3, 0xf3,
            0xc3, 0xc3, 0xc0, 0xc0, 0xc0, 0xc0, 0xf0, 0xf0, 0x30, 0x30, 0xf8, 0xfc, 0x0c, 0x0e, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03
        },

        {
            // 'walk2', 32x34px
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0xcf, 0xcf, 0x7f, 0x3f, 0x3f, 0x3f, 0x1f, 0x1f, 0x3c, 0x3c, 0x30, 0x70, 0xc0, 0xc0, 0x00, 0x00,
            0xfc, 0xfc, 0xc3, 0x83, 0x03, 0x07, 0x0c, 0x0c, 0x0c, 0x1c, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
            0x1f, 0x0f, 0x00, 0x00, 0x00, 0x00, 0x1e, 0x1e, 0x00, 0x00, 0x00, 0x30, 0xf3, 0xf3, 0x0c, 0x0c,
            0x3c, 0x3c, 0xf7, 0xe3, 0x83, 0x00, 0x00, 0x00, 0xfc, 0xfc, 0xcc, 0xcc, 0xc0, 0xc0, 0xc0, 0xc0,
            0xc0, 0xc0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x81, 0xff, 0xff,
            0x00, 0x00, 0x00, 0x00, 0x03, 0x03, 0x0f, 0x0f, 0x0c, 0x0c, 0xff, 0xff, 0x1f, 0x1f, 0x3c, 0x3c,
            0x30, 0x30, 0xf0, 0xf0, 0x30, 0x30, 0x3c, 0x3c, 0xcc, 0xcc, 0x0e, 0x0f, 0x03, 0x03, 0x00, 0x00,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03
        },
    };

    // Animation assumes 1 frame prep stage
    void animation_phase(void) {
        if (get_current_wpm() <= IDLE_SPEED) {
            current_idle_frame = (current_idle_frame + 1) % IDLE_FRAMES;
            oled_write_raw_P(idle[abs((IDLE_FRAMES - 1) - current_idle_frame)], ANIM_SIZE);
        }
        if (get_current_wpm() > IDLE_SPEED && get_current_wpm() < TAP_SPEED) {
            //  oled_write_raw_P(prep[abs((PREP_FRAMES-1)-current_prep_frame)], ANIM_SIZE); // Uncomment if PREP_FRAMES > 1
            oled_write_raw_P(prep[0], ANIM_SIZE);  // Comment if PREP_FRAMES >1
        }
        if (get_current_wpm() >= TAP_SPEED) {
            current_tap_frame = (current_tap_frame + 1) % TAP_FRAMES;
            oled_write_raw_P(tap[abs((TAP_FRAMES - 1) - current_tap_frame)], ANIM_SIZE);
        }
    }

    if (get_current_wpm() != 000) {
        oled_on();  // Turns on animation OLED with any alpha keypress
        if (timer_elapsed32(anim_timer) > ANIM_FRAME_DURATION) {
            anim_timer = timer_read32();
            animation_phase();
        }
        anim_sleep = timer_read32();
    } else {
        if (timer_elapsed32(anim_sleep) > OLED_TIMEOUT) {
            oled_off();
        } else {
            if (timer_elapsed32(anim_timer) > ANIM_FRAME_DURATION) {
                anim_timer = timer_read32();
                animation_phase();
            }
        }
    }
}

// Render output to OLED
// oled_task_user() function overrides oled_task_kb() in oceanographer.c
bool oled_task_user(void) {
    // Print layer
    switch (get_highest_layer(layer_state)) {

        case 0:
            oled_write_ln_P(PSTR("Base"), false);
            break;

        case 1:
            oled_write_ln_P(PSTR("Sym"), false);
            break;

        case 2:
            oled_write_ln_P(PSTR("Num"), false);
            break;

        case 3:
            oled_write_ln_P(PSTR("Nav"), false);
            break;

        case 4:
            oled_write_ln_P(PSTR("Fun"), false);
            break;

        default:
            oled_write_ln_P(PSTR("Undef"), false);
    }

    oled_write_ln_P(PSTR(""), false);

    oled_write_ln_P(PSTR("Lock:"), false);
    
    led_t led_state = host_keyboard_led_state();
        
    oled_write_P(led_state.caps_lock ? PSTR("Caps ") : PSTR("     "), false);
    oled_write_P(led_state.scroll_lock ? PSTR("Scrl ") : PSTR("     "), false);
    oled_write_P(led_state.num_lock ? PSTR("Num  ") : PSTR("     "), false);

    oled_write_ln_P(PSTR(""), false);

    sprintf(wpm_str, "WPM: %03d", get_current_wpm());  // edit the string to change what shows up, edit %03d to change how many digits show up
    oled_write_ln(wpm_str, false);      

    // Render pixel art
    render_anim();

    return false;
}
#endif

